<html>

<head>

    <title>Endless scrolling example.</title>

    <!-- Include the MooTools framework. -->

    <!-- Note: we'll use id's to select objects since it's faster. -->

</head>

<style>

    .menu {
        float: left;
        width: 250px;
        height: 1000px;
        background: #eee;
    }

    body {
        height: 20000px;
    }

    ul {
        position: fixed;
        top: 0;
        left: 300px;
        width: 200px;
        float: left;
    }

    li {
        display: block; float: left; height: 20px; line-height: 20px; border-bottom: 1px solid #000;
    }
</style>
<body>

<div class="menu">

</div>

<!-- Scroll up. -->
<!--<a href="javascript:void(0);" id="list_up_button">Up!</a>-->

<!-- The list (i.e. container). -->
<ul id="list_container" >
</ul>

<!-- Scroll down. -->
<!--<a href="javascript:void(0);" id="list_down_button">Down!</a>-->

</body>

<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mootools/1.4.5/mootools-core-full-compat-yc.min.js"></script>
<!-- Our script. -->
<script type="text/javascript">


        // database
        var list = {};

        // options
        var list_size = 1000;   // total list size
        var list_offset = 0;    // initial list position
        var list_subset = 32;   // the smount of displayed items
        var scroll_step = null;    // items to scroll in one step
        var time_delay = 50;    // time delay between scroll steps

        // make dummy items
        for (var i = 0; i < list_size; i++) {
            var red = Math.floor(i * 2) % 256;
            var green = Math.floor(i * 3) % 256;
            var blue = Math.floor(i * 4) % 256;

            list[i] = "<span style=\"color:rgb(" + red + ", " + green + ", " + blue + ");\">" +
                "My name is 'Object no." + (i + 1) + "'." +
                "</span>";
        }

        // get container
        var list_container = $('list_container')

        // generate DOM objects
        for (var i = 0; i < list_subset; i++) {
            list_container.grab(new Element('li', {html: list[i]}));
        }

        // Up scroller.
        function up() {

            // check end
            if (list_offset <= 0) {
                return false;
            }

            // get element
            var element = list_container.getLast();

            // devance offset
            list_offset--;

            // re-write element
            element.set('html', list[list_offset]);

            // move top element to top
            list_container.grab(element, 'top');

            // success
            return true;
        }

        function steps(stepPx, fn){

            var itemsCount = Math.round(Math.abs(stepPx)/20);

            console.log('stepPx: '+stepPx+', itemsCount: '+itemsCount);

            scroll_step = itemsCount;
            fn();

        }

        // Down scroller.
        function down() {

            // check end
            if (list_offset >= list_size - list_subset) {
                return false;
            }

            // get element
            var element = list_container.getFirst();

            // advance offset
            list_offset++;

            // re-write element
            element.set('html', list[list_offset + list_subset - 1]);

            // move top element to bottom
            list_container.grab(element, 'bottom');

            // success
            return true;
        }

        // Repeater function.
        function repeater(direction) {

            for (var i = 0; i < scroll_step; i++) {

                // scroll
                if (direction() == false) {

                    // deactivate repeater
                    $clear(list.scroll_period);
                }
            }

        }

        // configure up scroll
//        $('list_up_button').addEvents({
//
//            // activate scroll
//            'mouseenter': function () {
//                list.scroll_period = repeater.periodical(time_delay, null, up);
//            },
//
//            // deactivate scroll
//            'mouseleave': function () {
//                $clear(list.scroll_period);
//            }
//        });

        // configure up scroll
//        $('list_down_button').addEvents({
//
//            // activate scroll
//            'mouseenter': function () {
//                list.scroll_period = repeater.periodical(time_delay, null, down);
//            },
//
//            // deactivate scroll
//            'mouseleave': function () {
//                $clear(list.scroll_period);
//            }
//        });


</script>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script type="text/javascript">

    //no conflict jquery
    jQuery.noConflict();
    //jquery stuff
    (function ($, list, $clear) {
        // extension:
        $.fn.scrollEnd = function (callback, timeout) {
            $(this).scroll(function () {
                var $this = $(this);
                if ($this.data('scrollTimeout')) {
                    clearTimeout($this.data('scrollTimeout'));
                }
                $this.data('scrollTimeout', setTimeout(callback, timeout));
            });
        };

        // how to call it (with a 1000ms timeout):
//        $(window).scrollEnd(function () {
//            console.log('stopped scrolling');
//           // $clear(list.scroll_period);
//        }, 100);

        var lastScrollTop = 0;
        $(window).scroll(function (event) {
            var st = $(this).scrollTop();
            var scrollStep = lastScrollTop-st;

            if (st > lastScrollTop) {
                steps(scrollStep, down);
             //    list.scroll_period = repeater.periodical(time_delay, null, down);
            } else {
                steps(scrollStep, up);
                // list.scroll_period = repeater.periodical(time_delay, null, up);
                // upscroll code
            }

            lastScrollTop = st;
        });

    })(jQuery, list, $clear);

</script>